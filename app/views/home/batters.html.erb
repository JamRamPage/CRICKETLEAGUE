<p id="notice"><%= notice %></p>

<h1><%= I18n.t('.navbar.batters') %></h1>

<table class="center">
  <thead>
    <tr>
      <th><%= I18n.t('.home.stats.name') %></th>
      <th><%= I18n.t('.home.stats.team') %></th>
      <th><%= I18n.t('.home.stats.runs') %></th>
      <th><%= I18n.t('.home.stats.avg') %></th>
      <th><%= I18n.t('.home.stats.fours') %></th>
      <th><%= I18n.t('.home.stats.sixes') %></th>
      <th><%= I18n.t('.home.stats.high_score') %></th>
      <th><%= I18n.t('.home.stats.matches') %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @batters.each do |player| #For each player, sorted by the number of runs they have scored across all their matches %>
    <% #The total matches that the current player has batted in:
       matchesPlayed = player.matchesBatted.where("player_id" => player).count("*")[player.name.to_s]
       #The batting statistics for the current player across all matches
       batterStats = player.battingStats.where("player_id" => player)
       #The amount of total runs the player has scored over all matches
       batterRuns = batterStats.sum("runs")[player.name.to_s]
       #The average runs scored per innings (if player has not batted yet, then output "")
       if (matchesPlayed.to_f != 0) then
          batterAverage = batterRuns.to_f / matchesPlayed.to_f
       else
          batterAverage = ""
       end
       #Number of 4s, 6s and their high score across all inningses:
       batterFours = batterStats.sum("fours")[player.name.to_s]
       batterSixes = batterStats.sum("sixes")[player.name.to_s]
       batterHighScore = batterStats.maximum("runs")[player.name.to_s]
       %>
      <tr>
        <td><%= player.name %></td>
        <td><%= player.team.name %></td>
        <td><%= player.totalRunsBatted%></td>
        <td><%= batterAverage%></td>
        <td><%= batterFours%></td>
        <td><%= batterSixes%></td>
        <td><%= batterHighScore%></td>
        <td><%= matchesPlayed %></td>
        <td><%= link_to 'Show', player %></td>
        <td><%= link_to 'Edit', edit_player_path(player) %></td>
        <td><%= link_to 'Destroy', player, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
